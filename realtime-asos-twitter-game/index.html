<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>Realtime Twitter game: ASOS Two-Up - ashleyd.ws</title>
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="../assets/img/favicon.ico">
<link rel="apple-touch-icon" sizes="57x57" href="../assets/img/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://ashleyd.ws/assets/img/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://ashleyd.ws/assets/img/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://ashleyd.ws/assets/img/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="60x60" href="../assets/img/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://ashleyd.ws/assets/img/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://ashleyd.ws/assets/img/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://ashleyd.ws/assets/img/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://ashleyd.ws/assets/img/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="https://ashleyd.ws/assets/img/favicon-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="https://ashleyd.ws/assets/img/favicon-160x160.png" sizes="160x160">
<link rel="icon" type="image/png" href="https://ashleyd.ws/assets/img/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../assets/img/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../assets/img/favicon-32x32.png" sizes="32x32">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-TileImage" content="/assets/img/mstile-144x144.png">
<meta name="msapplication-config" content="/assets/img/browserconfig.xml">
<link rel="stylesheet" type="text/css" href="../assets/css/uno.css?v=sdfgys" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,700,600' rel='stylesheet' type='text/css'>
<link rel="canonical" href="index.html" />
<meta name="referrer" content="origin" />
<meta property="og:site_name" content="ashleyd.ws" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Realtime Twitter game: ASOS Two-Up" />
<meta property="og:description" content="ASOS Australia wanted to run an Anzac Day promotional Twitter game similar to that of the Australian game &quot;Two-Up&quot; (https://en.wikipedia.org/wiki/Two-up). The logic behind the game itself is straightforward - flip two coins and compare the..." />
<meta property="og:url" content="https://ashleyd.ws/realtime-asos-twitter-game/" />
<meta property="article:published_time" content="2015-11-17T16:41:59.000Z" />
<meta property="article:modified_time" content="2016-01-12T10:56:48.000Z" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Realtime Twitter game: ASOS Two-Up" />
<meta name="twitter:description" content="ASOS Australia wanted to run an Anzac Day promotional Twitter game similar to that of the Australian game &quot;Two-Up&quot; (https://en.wikipedia.org/wiki/Two-up). The logic behind the game itself is straightforward - flip two coins and compare the..." />
<meta name="twitter:url" content="https://ashleyd.ws/realtime-asos-twitter-game/" />
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "ashleyd.ws",
    "author": {
        "@type": "Person",
        "name": "Ashley",
        "url": "https://ashleyd.ws/author/ashley",
        "sameAs": null,
        "description": null
    },
    "headline": "Realtime Twitter game: ASOS Two-Up",
    "url": "https://ashleyd.ws/realtime-asos-twitter-game/",
    "datePublished": "2015-11-17T16:41:59.000Z",
    "dateModified": "2016-01-12T10:56:48.000Z",
    "description": "ASOS Australia wanted to run an Anzac Day promotional Twitter game similar to that of the Australian game &quot;Two-Up&quot; (https://en.wikipedia.org/wiki/Two-up). The logic behind the game itself is straightforward - flip two coins and compare the..."
}
    </script>
<meta name="generator" content="Ghost 0.7" />
<link rel="alternate" type="application/rss+xml" title="ashleyd.ws" href="../rss/index.html" />
</head>
<body class="post-template">
<section id="cover-button" class="collapsed">
<a><i class="icon icon-list"></i></a>
</section>
<aside class="cover collapsed">
<div class="cover container collapsed">
<div class="profile">
<a id="avatar-link" title="link to homepage for ashleyd.ws" href="../index.html#open">
<img src="../content/images/2015/03/ashleydws_logo-2.png" alt="ashleyd.ws avatar" class="profile avatar hvr-buzz-out" />
</a>
<hr class="divider long" />
<p>So web 3.0, I used my name for a domain</p>
<hr class="divider short" />
<div class="navigation">
<div class="profile contact">
<nav class="navigation left">
<ul class="links">
<li class="links item">
<a href="mailto:hello@ashleyd.ws" class="link-item" title="" id="contact-button">Contact</a>
</li>
</ul>
</nav>
<nav class="navigation right">
<ul class="social expanded">

<li class="social item hvr-grow-rotate">
<a target="blank" href="https://twitter.com/apd_white" title="@apd_white on Twitter">
<i class='icon icon-social-twitter'></i>
<span class="label">Twitter</span>
</a>
</li>

<li class="social item hvr-grow-rotate">
<a target="blank" href="https://www.linkedin.com/in/ashleydw" title="ashleydw on LinkedIn">
<i class='icon icon-social-linkedin'></i>
<span class="label">Linkedin</span>
</a>
</li>

<li class="social item hvr-grow-rotate">
<a target="blank" href="https://github.com/ashleydw" title="ashleydw on Github">
<i class='icon icon-social-github'></i>
<span class="label">Github</span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
</div>
</aside>
<article class="main">
<section id="search-results"></section>
<section class="content">
<article class="post">
<header>
<a id="back-button" class="btn small square" href="javascript:history.back()">« Back</a>
<div class="post meta">
<time datetime="17 Nov 2015">17 Nov 2015</time>
<span class="post tags"></span>
<span class="post reading-time"> – <span></span> read.</span>
</div>
<a href="https://twitter.com/intent/tweet?url=https://ashleyd.ws/realtime-asos-twitter-game/;text=Realtime Twitter game: ASOS Two-Up » " alt="Tweet 'Realtime Twitter game: ASOS Two-Up'" target="_blank">
<h1 class="icon-reverse icon-social-twitter-post" id="post-title">Realtime Twitter game: ASOS Two-Up.</h1>
</a>
</header>
<section class="post">
<p>ASOS Australia wanted to run an Anzac Day promotional Twitter game similar to that of the Australian game "Two-Up" (<a href="https://en.wikipedia.org/wiki/Two-up">https://en.wikipedia.org/wiki/Two-up</a>). The logic behind the game itself is straightforward - flip two coins and compare the result to the users guess - the key challenges surround running the game on Twitter in realtime.</p>
<p><img src="../content/images/2015/11/Screen-Shot-2015-11-17-at-18-03-07.png" alt="" /></p>
<p>The aim of the game was to produce a high engagement and sharing rate on the ASOS AU Twitter account for a period of time building up to, and contributing to the promotions held on the day.</p>
<p>The image shows some basic statistical results. As is shown, the game targets were well exceeded. Over the 5 hour period, the game processed over ten thousand Tweets. From the start I had recognised that ASOS has a huge social media following, and the game may be more popular than imagined; because of this I had built the system so that any number of processors could be started to handle increased traffic.</p>
<p>The automatic reply system meant that the ASOS twitter account had to reply to around 10,000 Tweets in the time period. Twitter has API rate limiting that would normally prevent this, however, the ASOS Twitter account is whitelisted for unlimited API usage.</p>
<div style="text-align:center">
<img src="../content/images/2015/11/asos-twitter-game-results.png" alt="Game statistics" width="400" style="margin:auto; margin-bottom:25px;" />
</div>
<p>The code is bespoke to the ASOS game requirements, and honestly rather simple once divided into separate systems. However, hopefully this post can inspire others how to create such a system.</p>
<p>The game system broken down into stages:</p>
<ul>
<li>Listen for Tweets directed to the ASOS AU Twitter account that contain the hashtag used for the game (#TwoUp).
<ul><li>Store the Tweet.</li></ul></li>
<li>Process Tweets as quickly as possible in FIFO method:
<ul><li>Filter out Tweets with offensive words and retweets.</li>
<li>Rate limit users to N entries every 5 minutes.</li>
<li>Extract the guess from the Tweet; a string containing a single valid guess was accepted (a user could not have #Heads and #Tails in the same Tweet).</li>
<li>If the user guessed correctly; winners were entered into a second round where they had the potential to win a prize.</li>
<li>Based on the second round win/loss, winning Tweets were given a prize; the game rules specified that a human was required had to be involved in this process so a realtime dashboard was developed for ASOS to monitor the game and reply to Tweets with prize information.</li>
<li>Losing tweets receive an automatic reply from a number of pre-written replies with images.</li></ul></li>
</ul>
<p>Simply put; receiving, storing, and processing Tweets. The receiving and processing components were written in Python; for no other reason than I felt it was the best adapted language to the requirements and time period I had to produce the system. The storage system was Redis, and the dashboard used to monitor the game was written in PHP and standard frontend technologies.</p>
<p><img src="../content/images/2015/11/Screenshot_2015-04-24-22-05-18.png" alt="Screenshot of the ASOS Australia Twitter account" width="200" style="float:right; margin-left:25px; margin-bottom:25px;" /></p>
<p>A couple of example replies are shown in the app screenshot; one person being rate-limited, another losing their try.</p>
<p>For the first stage - receiving Tweets - the Twitter API allows a subscription to be created that allows an API to listen for hashtags for a particular account. Having already worked on a similar process for GOTags, I was familiar with the problems that arise when using a subscription based API; connectivity issues with both their API and mine are potential problems, as too is the possibility that a large volume of data will be received. The receiving endpoint needs to be able to receive a Tweet and offload it into the storage system as quickly as possible.</p>
<p>In-memory databases are favourable when requiring as near real-time systems as possible, as such I used Redis. Data was stored in a list data structure; this allowed me to use POP and PUSH methods on the list; creating a FIFO queue of Tweets waiting to be processed that any of the processor component could access.</p>
<p>A processor process polls the Redis database for Tweets to process. The Tweet is then processed through the game logic, and either passed onto the second stage of the game or immediately replied to with a losing message. These processors had two layers of fault tolerance; on API/database failure the processor would restart itself, if the process completely stopped, Supervisor would restart it.</p>
<p>I started the game with two processors running, but soon realised the volume of Tweets was causing a delay in processing (at a maximum, 30 minutes into the game, the delay was around 45 seconds). Because of this, I threw more server kittens at the game, and started 5 more processors; this reduced the processing to between 1 and 2 seconds. In hind-sight, I should have started large and scaled down if the server was struggling to cope.</p>
<p>The majority of the time spent whilst processing replies was uploading the Tweet images to the Twitter API. It's unfortunate that media images are bespoke to each Tweet, as a faster solution would have been to reuse the same images already hosted on Twitter. However, apart from a few exceptions, the images were mostly under 300kb so the delay was minimal.</p>
<p>The individual components of the system performed well, and no failures were experienced. At the end of the five hour period, the subscription was removed and the processors gracefully stopped.</p>
<p>The game was a huge success and there are rumours flying around that a similar game will be played but on a global basis. The system to manage the amount of Tweets that a global game will attract will be substantial.</p>
</section>
</article>
<section class="post-comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
  // required: replace example with your forum shortname
  var disqus_shortname = 'ashleydws';
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>
<footer>
<span class="copyright">
&copy; 2018. All rights reserved. Built with <a href="https://ghost.org/" target="_blank">Ghost</a> and <a href="https://github.com/Kikobeats/uno-zen" target="_blank">Uno Zen</a> theme.
</span>
</footer>
</section>
</article>

<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="../assets/js/uno.js?v=09ed73b301"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-41134916-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
